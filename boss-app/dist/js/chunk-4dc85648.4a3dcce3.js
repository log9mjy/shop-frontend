(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4dc85648"],{1400:function(t,e,i){"use strict";i("ca82")},"1ca6":function(t,e,i){"use strict";i("4296")},"1daf":function(t,e,i){},3399:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"layout-card"},[i("div",{staticClass:"layout-head"},[i("div",[i("span",{class:[t.step>0?"layout-active-title":""]},[t._v("1.编辑基本信息")]),i("span",{class:[1===t.step?"layout-active-label":""]})]),i("div",[i("span",{class:[t.step>1?"layout-active-title":""]},[t._v("2.编辑商品详情")]),i("span",{class:[2===t.step?"layout-active-label":""]})]),i("div",[i("span",{class:[t.step>2?"layout-active-title":""]},[t._v("3.编辑商品规格")])])]),i("div",{staticClass:"layout-container"},[1===t.step?i("div",[i("div",{staticClass:"layout-title"},[t._v("基本信息")]),i("div",{staticClass:"layout-content"},[i("el-form",{ref:"base-info",attrs:{size:"small","label-width":"100px",model:t.form,rules:t.rules}},[i("el-form-item",{attrs:{label:"商品名称",prop:"name"}},[i("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"输入商品名称",type:"textarea",maxlength:100,"show-word-limit":""},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),i("el-form-item",{attrs:{label:"商品说明",prop:"project_describe"}},[i("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"输入商品说明",type:"textarea",maxlength:100,"show-word-limit":""},model:{value:t.form.project_describe,callback:function(e){t.$set(t.form,"project_describe",e)},expression:"form.project_describe"}})],1),i("el-form-item",{attrs:{label:"商品品牌",prop:"brand_id"}},[i("el-select",{staticStyle:{width:"100px"},attrs:{clearable:""},model:{value:t.form.brand_id,callback:function(e){t.$set(t.form,"brand_id",e)},expression:"form.brand_id"}},t._l(t.options,(function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1)],1)],1),i("div",{staticClass:"layout-title"},[t._v("商品图片")]),i("div",{staticClass:"layout-content"},[i("upload",{attrs:{limit:5,"file-list":t.albums.map((function(t){return t.url}))},on:{success:t.uploadAlbum,del:t.delAlbum}})],1)]):t._e(),2===t.step?i("div",[i("div",{staticClass:"layout-title"},[t._v("详情图片")]),i("div",{staticClass:"layout-content"},[i("upload",{attrs:{limit:30,"file-list":t.details.map((function(t){return t.url}))},on:{success:t.uploadDetail,del:t.delDetail}})],1)]):t._e(),3===t.step?i("div",[i("div",{staticClass:"layout-title"},[t._v("商品规格 "),i("el-button",{attrs:{size:"mini",icon:"el-icon-plus"},on:{click:t.addSpecification}},[t._v("新增")])],1),t._l(t.specifications,(function(e,a){return i("div",{key:a,staticStyle:{position:"relative"}},[i("div",{staticClass:"layout-title"},[i("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"输入规格项"},model:{value:e.title,callback:function(i){t.$set(e,"title",i)},expression:"item.title"}}),i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{icon:"el-icon-plus"},on:{click:function(e){return t.addSpecificationValue(a)}}},[t._v("新增 ")])],1),i("div",{staticClass:"layout-content specification-wrapper"},t._l(e.values,(function(s,n){return i("div",{key:n,staticClass:"attr-wrapper"},[i("el-input",{attrs:{placeholder:"输入"+e.title},model:{value:s.value,callback:function(e){t.$set(s,"value",e)},expression:"p.value"}}),i("div",{staticClass:"del",on:{click:function(e){return t.delSpecificationValue(a,n)}}},[t._v("x")])],1)})),0),i("div",{staticClass:"del-left",on:{click:function(e){return t.delSpecification(a)}}},[t._v("x")])])})),i("div",{staticClass:"layout-title"},[t._v("商品规格 "),i("el-button",{attrs:{size:"mini",icon:"el-icon-refresh"},on:{click:t.refreshSku}},[t._v("刷新")])],1),i("div",{staticClass:"sku-container"},t._l(t.skus,(function(e,a){return i("div",{key:a,staticClass:"sku-wrapper"},[i("el-form",{attrs:{"label-width":"80px"}},[t._l(e.specifications,(function(e,a){return i("el-form-item",{key:a,attrs:{label:e.key}},[i("el-input",{staticStyle:{width:"200px"},attrs:{disabled:""},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"s.value"}})],1)})),i("el-form-item",{attrs:{label:"价格"}},[i("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"输入价格"},model:{value:e.project_price,callback:function(i){t.$set(e,"project_price",i)},expression:"item.project_price"}})],1),i("el-form-item",{attrs:{label:"库存"}},[i("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"输入库存"},model:{value:e.project_stock,callback:function(i){t.$set(e,"project_stock",i)},expression:"item.project_stock"}})],1),i("el-form-item",{attrs:{label:"排序"}},[i("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"输入排序"},model:{value:e.specs_seq,callback:function(i){t.$set(e,"specs_seq",i)},expression:"item.specs_seq"}})],1)],2),i("div",{staticClass:"del"},[t._v("x")])],1)})),0)],2):t._e()]),1===t.step?i("div",{staticClass:"layout-bottom"},[i("el-button",{attrs:{size:"mini",icon:"el-icon-arrow-left"},on:{click:t.back}},[t._v("返回")]),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.changeStep(2)}}},[t._v("下一步")])],1):t._e(),2===t.step?i("div",{staticClass:"layout-bottom"},[i("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.changeStep(1)}}},[t._v("上一步")]),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.changeStep(3)}}},[t._v("下一步")])],1):t._e(),3===t.step?i("div",{staticClass:"layout-bottom"},[i("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.changeStep(2)}}},[t._v("上一步")]),i("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-upload2"},on:{click:t.save}},[t._v("保存")])],1):t._e()])])},s=[],n=(i("b0c0"),i("d81d"),i("d3b7"),i("ddb0"),i("a434"),i("c912")),c=i("decf"),l=i("c40e"),r={name:"index",components:{Upload:c["a"],MiniUpload:n["a"]},data:function(){return{id:this.$route.query.id,step:1,options:[],form:{name:"",project_describe:"",brand_id:""},rules:{name:[{required:!0,message:"请输入"}],project_describe:[{required:!0,message:"请输入"}],brand_id:[{required:!0,message:"请选择"}]},albums:[],details:[],specifications:[],skus:[]}},mounted:function(){var t=this;Object(l["e"])({id:this.id}).then((function(e){t.form={name:e.data.name,project_describe:e.data.project_describe,brand_id:e.data.brand_id},t.specifications=e.data.attributeKey.map((function(t){var e=t.attributeValue.map((function(t){return{value:t}}));return{title:t.attribute_name,values:e}}));var i=t.specifications.length;t.skus=e.data.project_specs.map((function(e){for(var a=[],s=0;s<i;s++){var n=e[s+""],c=t.specifications[s].title;a.push({key:c,value:n[c]})}return{specs_seq:e.specs_seq,project_stock:e.project_stock,project_price:e.project_price,specifications:a}}))})),Object(l["a"])().then((function(e){t.options=e.list}))},methods:{back:function(){this.$router.push({path:"/goods/list"})},save:function(){var t=this,e={brand_id:this.form.brand_id+"",project_describe:this.form.project_describe,name:this.form.name};0===this.albums.length&&this.$message.error("请上传商品图片");var i=this.albums.map((function(t){return{is_default:"0",url:t.path}}));i[0].is_default="1",e.shop_image=i,e.details=this.details.map((function(t){return t.path}));var a={};this.specifications.map((function(t){a[t.title]=t.values.map((function(t){return t.value}))})),e.attribute_key=a,e.project_specs=this.skus.map((function(t){var e=t.specifications.map((function(t){var e={};return e[t.key]=t.value,e}));return{specs_seq:t.specs_seq,project_stock:t.project_stock,project_price:t.project_price,project_specs:e}})),goods_add(e).then((function(){t.$message.success("商品新增成功")}))},uploadSpecPic:function(t,e,i){this.specifications[e].values[i].albums.push(t)},delSpecPic:function(t,e,i){this.specifications[e].values[i].albums.splice(t,1)},changeStep:function(t){var e=this;2===t&&1===this.step?this.$refs["base-info"].validate((function(t){t&&(e.step=2)})):this.step=t},uploadAlbum:function(t){this.albums.push(t)},delAlbum:function(t){this.albums.splice(t,1)},uploadDetail:function(t){this.details.push(t)},delDetail:function(t){this.details.splice(t,1)},addAttribute:function(){this.attributes.push({key:"",value:""})},delAttribute:function(t){this.attributes.splice(t,1)},delSpecification:function(t){this.specifications.splice(t)},addSpecification:function(){this.specifications.push({title:"",values:[]})},addSpecificationValue:function(t){this.specifications[t].values.push({value:""})},delSpecificationValue:function(t,e){this.specifications[t].values.splice(e,1)},refreshSku:function(){this.skus=[],this.combinationSku(this.skus,this.specifications,[],0)},combinationSku:function(t,e,i,a){if(e.length!==a)for(var s=0;s<e[a].values.length;s++)i[a]=e[a].values[s],this.combinationSku(t,e,i,a+1);else{for(var n=[],c=0;c<i.length;c++)n.push({key:e[c].title,value:i[c].value});t.push({specifications:n,project_stock:"0",project_price:"0",specs_seq:"0"})}}}},o=r,u=(i("1400"),i("2877")),p=Object(u["a"])(o,a,s,!1,null,"12322ac8",null);e["default"]=p.exports},4296:function(t,e,i){},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,i){var a=i("1d80"),s=i("5899"),n="["+s+"]",c=RegExp("^"+n+n+"*"),l=RegExp(n+n+"*$"),r=function(t){return function(e){var i=String(a(e));return 1&t&&(i=i.replace(c,"")),2&t&&(i=i.replace(l,"")),i}};t.exports={start:r(1),end:r(2),trim:r(3)}},7156:function(t,e,i){var a=i("861d"),s=i("d2bb");t.exports=function(t,e,i){var n,c;return s&&"function"==typeof(n=e.constructor)&&n!==i&&a(c=n.prototype)&&c!==i.prototype&&s(t,c),t}},"8b43":function(t,e,i){"use strict";i("1daf")},"91b6":function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var a=i("4020");function s(t){return Object(a["b"])("/file/upload-file",t)}},a9e3:function(t,e,i){"use strict";var a=i("83ab"),s=i("da84"),n=i("94ca"),c=i("6eeb"),l=i("5135"),r=i("c6b6"),o=i("7156"),u=i("c04e"),p=i("d039"),f=i("7c73"),d=i("241c").f,m=i("06cf").f,v=i("9bf2").f,h=i("58a8").trim,b="Number",_=s[b],g=_.prototype,k=r(f(g))==b,y=function(t){var e,i,a,s,n,c,l,r,o=u(t,!1);if("string"==typeof o&&o.length>2)if(o=h(o),e=o.charCodeAt(0),43===e||45===e){if(i=o.charCodeAt(2),88===i||120===i)return NaN}else if(48===e){switch(o.charCodeAt(1)){case 66:case 98:a=2,s=49;break;case 79:case 111:a=8,s=55;break;default:return+o}for(n=o.slice(2),c=n.length,l=0;l<c;l++)if(r=n.charCodeAt(l),r<48||r>s)return NaN;return parseInt(n,a)}return+o};if(n(b,!_(" 0o1")||!_("0b1")||_("+0x1"))){for(var j,C=function(t){var e=arguments.length<1?0:t,i=this;return i instanceof C&&(k?p((function(){g.valueOf.call(i)})):r(i)!=b)?o(new _(y(e)),i,C):y(e)},S=a?d(_):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),x=0;S.length>x;x++)l(_,j=S[x])&&!l(C,j)&&v(C,j,m(_,j));C.prototype=g,g.constructor=C,c(s,b,C)}},b0c0:function(t,e,i){var a=i("83ab"),s=i("9bf2").f,n=Function.prototype,c=n.toString,l=/^\s*function ([^ (]*)/,r="name";a&&!(r in n)&&s(n,r,{configurable:!0,get:function(){try{return c.call(this).match(l)[1]}catch(t){return""}}})},c40e:function(t,e,i){"use strict";i.d(e,"c",(function(){return s})),i.d(e,"d",(function(){return n})),i.d(e,"f",(function(){return c})),i.d(e,"e",(function(){return l})),i.d(e,"a",(function(){return r})),i.d(e,"b",(function(){return o}));var a=i("4020");function s(t){return Object(a["c"])("/project/add",t,!0)}function n(t){return Object(a["c"])("/project/del",t,!0)}function c(t){return Object(a["a"])("project/manage-list",t,!0)}function l(t){return Object(a["a"])("project/detail-page",t,!0)}function r(){return Object(a["a"])("brand/manage-list",{},!1)}function o(){return Object(a["a"])("category/manage-list",{},!1)}},c912:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"upload-view"},[t._l(t.fileList,(function(e,a){return i("div",{key:a,class:["lk-upload-image-container",0!==a?"margin-left":""]},[i("el-image",{staticClass:"lk-upload-image",attrs:{"preview-src-list":t.fileList,src:e,fit:"cover"}}),i("i",{staticClass:"el-icon-remove del-image",on:{click:function(e){return t.delImage(a)}}})],1)})),t.limit>t.fileList.length?i("div",{class:["lk-upload",t.fileList.length>0?"margin-left":""],on:{click:t.handleClick}},[i("input",{ref:"uploadImage",staticClass:"lk-upload-input",attrs:{type:"file",accept:".jpg, .jpeg, .png, .gif"},on:{change:t.doUpload}})]):t._e()],2)},s=[],n=(i("a9e3"),i("91b6")),c={props:{fileList:{type:Array,default:function(){return[]}},limit:{type:Number,default:1}},methods:{delImage:function(t){this.$emit("del",t)},handleClick:function(){this.$refs.uploadImage.click()},doUpload:function(t){var e=this,i=t.target.files[0];Object(n["a"])(i).then((function(t){e.$message.success("上传成功"),e.$emit("success",t.url)}))}}},l=c,r=(i("1ca6"),i("2877")),o=Object(r["a"])(l,a,s,!1,null,"7f0858a6",null);e["a"]=o.exports},ca82:function(t,e,i){},d81d:function(t,e,i){"use strict";var a=i("23e7"),s=i("b727").map,n=i("1dde"),c=n("map");a({target:"Array",proto:!0,forced:!c},{map:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}})},decf:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"upload-view"},[t._l(t.fileList,(function(e,a){return i("div",{key:a,class:["lk-upload-image-container",0!==a?"margin-left":""]},[i("el-image",{staticClass:"lk-upload-image",attrs:{"preview-src-list":t.fileList,src:e,fit:"cover"}}),i("i",{staticClass:"el-icon-remove del-image",on:{click:function(e){return t.delImage(a)}}})],1)})),t.limit>t.fileList.length?i("div",{class:["lk-upload",t.fileList.length>0?"margin-left":""],on:{click:t.handleClick}},[i("input",{ref:"uploadImage",staticClass:"lk-upload-input",attrs:{type:"file",accept:".jpg, .jpeg, .png, .gif"},on:{change:t.doUpload}})]):t._e()],2)},s=[],n=(i("a9e3"),i("91b6")),c={props:{fileList:{type:Array,default:function(){return[]}},limit:{type:Number,default:1}},methods:{delImage:function(t){this.$emit("del",t)},handleClick:function(){this.$refs.uploadImage.click()},doUpload:function(t){var e=this,i=t.target.files[0];Object(n["a"])(i).then((function(t){e.$message.success("上传成功"),e.$refs.uploadImage.value=null,e.$emit("success",t)}))}}},l=c,r=(i("8b43"),i("2877")),o=Object(r["a"])(l,a,s,!1,null,"0725db80",null);e["a"]=o.exports}}]);
//# sourceMappingURL=chunk-4dc85648.4a3dcce3.js.map